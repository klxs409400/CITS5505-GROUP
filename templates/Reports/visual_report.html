<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Data Visualization Report</title>
    <!-- Chart.js and necessary libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.0.0"></script>
    <!-- Icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Theme JS -->
    <script src="{{ url_for('static', filename='js/Settings/theme.js') }}"></script>
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/report.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #7f5af0, #38bdf8);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2rem;
            color: #666;
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 16px;
            background-color: #4f6cf5;
            color: #ffffff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        
        .back-button:hover {
            background-color: #3b54c2;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 20px;
            transition: transform 0.3s ease;
        }
        
        .chart-card:hover {
            transform: translateY(-5px);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 15px;
        }
        
        .chart-notes {
            background-color: #f8f9fa;
            border-left: 3px solid #4f46e5;
            padding: 10px 15px;
            font-size: 0.9rem;
            color: #666;
            margin-top: 15px;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .toggle-button {
            background-color: #4f46e5;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 20px auto;
        }
        
        .toggle-button:hover {
            background-color: #3730a3;
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .collapsible-content.show {
            max-height: 2000px;
        }
        
        .explanation-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .explanation-section h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
        }
        
        .references {
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 12px;
            padding: 24px 32px;
            margin: 40px auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            font-size: 1rem;
            line-height: 1.8;
            color: #374151;
        }
        
        .references h2 {
            font-size: 1.4rem;
            margin-bottom: 18px;
            border-bottom: 2px solid #10b981;
            padding-bottom: 6px;
            color: #111827;
        }
        
        .references ul {
            list-style-type: decimal;
            padding-left: 20px;
            margin: 0;
        }
        
        .references li {
            margin-bottom: 14px;
            text-align: left;
        }
        
        .references a {
            color: #059669;
            text-decoration: underline;
        }
        
        .references a:hover {
            color: #047857;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
        }
        
        .summary-card h3 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #333;
        }
        
        .summary-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: #4f46e5;
            margin-bottom: 10px;
        }
        
        .summary-card .icon {
            font-size: 2rem;
            color: #4f46e5;
            margin-bottom: 15px;
        }
        
        .summary-card p {
            font-size: 0.9rem;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="{{ url_for('main.dashboard') }}" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
        <a href="{{ url_for('report.view_report', classic='true') }}" class="back-button" style="right: 20px; left: auto;">
            <i class="fas fa-share-alt"></i> Share Report
        </a>
        
        <div class="header">
            <h1>Sleep Data Visualization Report</h1>
            <p>Comprehensive analysis of your sleep patterns and quality</p>
        </div>
        
        <div class="summary-cards" id="summary-cards">
            <!-- Summary cards will be populated by JavaScript -->
            <div class="summary-card">
                <div class="icon"><i class="fas fa-clock"></i></div>
                <h3>Average Sleep Duration</h3>
                <div class="value" id="avg-duration">--</div>
                <p>Recommended: 7-9 hours</p>
            </div>
            
            <div class="summary-card">
                <div class="icon"><i class="fas fa-star"></i></div>
                <h3>Sleep Quality Score</h3>
                <div class="value" id="avg-quality">--</div>
                <p id="quality-text">Loading...</p>
            </div>
            
            <div class="summary-card">
                <div class="icon"><i class="fas fa-exclamation-circle"></i></div>
                <h3>Main Sleep Issue</h3>
                <div class="value" id="main-issue-pct">--</div>
                <p id="main-issue-text">Loading...</p>
            </div>
            
            <div class="summary-card">
                <div class="icon"><i class="fas fa-lightbulb"></i></div>
                <h3>Improvement Tip</h3>
                <div class="value"><i class="fas fa-mobile-alt"></i></div>
                <p>Reduce screen time before bed</p>
            </div>
        </div>
        
        <div class="dashboard">
            <!-- Sleep Duration Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Daily Sleep Duration</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sleepDurationChart"></canvas>
                </div>
                <div class="chart-notes">
                    <strong>Note:</strong> Adults should aim for 7-9 hours of sleep per night. Your average is 7.2 hours, which is within the recommended range.
                </div>
            </div>
            
            <!-- Sleep Quality Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Sleep Quality Trend</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sleepQualityChart"></canvas>
                </div>
                <div class="chart-notes">
                    <strong>Note:</strong> Your sleep quality has been consistently good, with scores above 15 indicating good quality sleep.
                </div>
            </div>
            
            <!-- Sleep Quality Distribution -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Sleep Quality Distribution</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sleepQualityPieChart"></canvas>
                </div>
                <div class="chart-notes">
                    <strong>Note:</strong> Most of your sleep nights (71%) fall into the good or excellent categories.
                </div>
            </div>
            
            <!-- Impact Factors Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h2 class="chart-title">Impact of Factors</h2>
                </div>
                <div class="chart-container">
                    <canvas id="factorsImpactChart"></canvas>
                </div>
                <div class="chart-notes">
                    <strong>Note:</strong> Exercise has the most positive impact on your sleep quality, while screen time before bed has the most negative impact.
                </div>
            </div>
            
            <!-- Sleep Dimensions Radar Chart -->
            <div class="chart-card full-width">
                <div class="chart-header">
                    <h2 class="chart-title">Sleep Quality Dimensions</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sleepDimensionsChart"></canvas>
                </div>
                <div class="chart-notes">
                    <strong>Note:</strong> Your sleep efficiency and sleep medication scores are excellent, while sleep disturbances could use improvement.
                </div>
            </div>
        </div>
        
        <button id="toggleExplanation" class="toggle-button">
            <i class="fas fa-info-circle"></i> Show Scoring Criteria
        </button>
        
        <div id="explanationContent" class="collapsible-content">
            <div class="explanation-section">
                <h2>Sleep Quality Scoring Criteria (0–3, higher is better)</h2>
                <p style="font-style: italic; color: #666;">
                    Based on the Pittsburgh Sleep Quality Index (PSQI) — Buysse et al., 1989. Scores are reversed so that higher values indicate better sleep quality.
                </p>
                <ul>
                    <li><b>Subjective Quality:</b> Very good = 3, Fair = 2, Poor = 1, Very poor = 0</li>
                    <li><b>Sleep Latency:</b> ≤15min = 3, 16–60min = 1, >60min = 0</li>
                    <li><b>Duration:</b> ≥7h = 3, 6–7h = 2, 5–6h = 1, &lt;5h = 0</li>
                    <li><b>Efficiency:</b> ≥85% = 3, 75–84% = 2, 65–74% = 1, &lt;65% = 0</li>
                    <li><b>Disturbances:</b> None = 3, Occasionally = 2, Often = 1, Frequent = 0</li>
                    <li><b>Sleep Meds:</b> None = 3, Occasionally = 2, Often = 1, Daily = 0</li>
                    <li><b>Daytime Dysfunction:</b> None = 3, Sometimes = 2, Often = 1, Severe = 0</li>
                </ul>
                
                <h2>Behavioral Factors Scoring Criteria for Sleep Quality (0–2, higher is better)</h2>
                <ul>
                    <li><b>Caffeine Intake:</b> No intake = 2, Daytime only = 1, Nighttime = 0</li>
                    <li><b>Exercise:</b> Intense night exercise = 0, Moderate daytime exercise = 2, No exercise = 1</li>
                    <li><b>Screen Time (Before Bed):</b> ≤15min = 2, 15–60min = 1, >60min = 0</li>
                    <li><b>Late-night Eating:</b> None = 2, Occasionally = 1, Often = 0</li>
                </ul>
                
                <p class="chart-explanation">
                    <strong>Explanation:</strong> These scoring criteria are designed based on evidence from sleep behavior research. 
                    Studies suggest that late-night caffeine intake and prolonged screen exposure can negatively affect sleep quality, 
                    while moderate daytime exercise and healthy eating habits are linked to better sleep. By quantifying these factors, 
                    the chart helps users understand how their daily habits contribute to overall sleep performance.
                </p>
            </div>
        </div>
        
        <button id="toggleReferences" class="toggle-button">
            <i class="fas fa-book"></i> Show References
        </button>
        
        <div id="referencesContent" class="collapsible-content">
            <section class="references">
                <h2>References</h2>
                <ul>
                    <li>Buysse, D. J., Reynolds, C. F., Monk, T. H., et al. (1989). The Pittsburgh Sleep Quality Index (PSQI): A New Instrument for Psychiatric Practice and Research. <em>Psychiatry Research, 28</em>(2), 193–213. <a href="https://doi.org/10.1016/0165-1781(89)90047-4" target="_blank">https://doi.org/10.1016/0165-1781(89)90047-4</a></li>
                    
                    <li>Knutson, K. L., & Van Cauter, E. (2008). Associations Between Sleep Loss and Increased Risk of Obesity and Diabetes. <em>Annals of the New York Academy of Sciences, 1129</em>, 287–304. <a href="https://doi.org/10.1196/annals.1417.033" target="_blank">https://doi.org/10.1196/annals.1417.033</a></li>
                
                    <li>Grandner, M. A., et al. (2010). Social and Behavioral Determinants of Perceived Insufficient Sleep. <em>Frontiers in Neurology, 1</em>, 8. <a href="https://doi.org/10.3389/fneur.2010.00008" target="_blank">https://doi.org/10.3389/fneur.2010.00008</a></li>
                    
                    <li>Clark, I., & Landolt, H. P. (2017). Coffee, caffeine, and sleep: A systematic review of epidemiological studies and randomized controlled trials. <em>Sleep Medicine Reviews</em>, 31, 70–78. <a href="https://www.sciencedirect.com/science/article/pii/S1087079216000150" target="_blank">https://www.sciencedirect.com/science/article/pii/S1087079216000150</a></li>
                    
                    <li>Chang, A. M., et al. (2015). Evening use of light-emitting eReaders negatively affects sleep, circadian timing, and next-morning alertness. <em>Proceedings of the National Academy of Sciences</em>, 112(4), 1232–1237. <a href="https://www.pnas.org/content/112/4/1232" target="_blank">https://www.pnas.org/content/112/4/1232</a></li>
                    
                    <li>St-Onge, M. P., et al. (2016). Meal timing and frequency: Implications for cardiovascular disease prevention: A scientific statement from the American Heart Association. <em>Circulation</em>, 135(9), e96–e121. <a href="https://www.ahajournals.org/doi/10.1161/CIR.0000000000000476" target="_blank">https://www.ahajournals.org/doi/10.1161/CIR.0000000000000476</a></li>
                </ul>
            </section>
        </div>
    </div>
    
<script>
    // Toggle explanation content
    document.getElementById('toggleExplanation').addEventListener('click', function() {
        const content = document.getElementById('explanationContent');
        content.classList.toggle('show');
        
        const button = document.getElementById('toggleExplanation');
        if (content.classList.contains('show')) {
            button.innerHTML = '<i class="fas fa-times-circle"></i> Hide Scoring Criteria';
        } else {
            button.innerHTML = '<i class="fas fa-info-circle"></i> Show Scoring Criteria';
        }
    });
    
    // Toggle references content
    document.getElementById('toggleReferences').addEventListener('click', function() {
        const content = document.getElementById('referencesContent');
        content.classList.toggle('show');
        
        const button = document.getElementById('toggleReferences');
        if (content.classList.contains('show')) {
            button.innerHTML = '<i class="fas fa-times-circle"></i> Hide References';
        } else {
            button.innerHTML = '<i class="fas fa-book"></i> Show References';
        }
    });
    
    // Initialize all charts and summary data when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Load summary data
        Promise.all([
            fetch('/api/sleep/duration').then(res => res.json()),
            fetch('/api/sleep/score').then(res => res.json()),
            fetch('/api/sleep/level-distribution').then(res => res.json())
        ]).then(([durationData, scoreData, distributionData]) => {
            // Calculate average duration
            const durations = durationData.map(d => d.duration);
            const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
            document.getElementById('avg-duration').textContent = avgDuration.toFixed(1) + 'h';
            
            // Calculate average quality score
            const scores = scoreData.data;
            const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;
            document.getElementById('avg-quality').textContent = Math.round(avgScore) + '/21';
            
            // Set quality text
            let qualityText = 'Poor quality sleep';
            if (avgScore >= 18) qualityText = 'Excellent quality sleep';
            else if (avgScore >= 14) qualityText = 'Good quality sleep';
            else if (avgScore >= 9) qualityText = 'Fair quality sleep';
            document.getElementById('quality-text').textContent = qualityText;
            
            // Find main sleep issue (for demo, we'll just use the distribution data)
            const total = distributionData.data.reduce((a, b) => a + b, 0);
            const poorPct = Math.round((distributionData.data[3] / total) * 100);
            document.getElementById('main-issue-pct').textContent = poorPct + '%';
            document.getElementById('main-issue-text').textContent = 'Difficulty falling asleep';
        });
        // Sleep Duration Chart
        fetch('/api/sleep/duration')
        .then(res => res.json())
        .then(data => {
            const labels = data.map(d => d.date);        // ['Mon', 'Tue', ...]
            const durations = data.map(d => d.duration); // [7, 6.5, ...]
            
            const ctx1 = document.getElementById('sleepDurationChart').getContext('2d');
            new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Sleep Duration (hours)',
                    data: durations,
                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                    borderRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000,
                    easing: 'easeOutQuart'
                },
                plugins: {
                    annotation: {
                        annotations: {
                            line1: {
                                type: 'line',
                                yMin: 7,
                                yMax: 7,
                                borderColor: 'rgba(75, 192, 192, 0.7)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                label: {
                                    content: 'Minimum Recommended (7h)',
                                    display: true,
                                    position: 'start'
                                }
                            },
                            line2: {
                                type: 'line',
                                yMin: 9,
                                yMax: 9,
                                borderColor: 'rgba(75, 192, 192, 0.7)',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                label: {
                                    content: 'Maximum Recommended (9h)',
                                    display: true,
                                    position: 'end'
                                }
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const value = context.raw;
                                if (value < 7) return 'Below recommended range';
                                if (value > 9) return 'Above recommended range';
                                return 'Within recommended range';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10,
                        title: {
                            display: true,
                            text: 'Hours'
                        }
                    }
                }
            }
        });
        });
        
        // Sleep Quality Chart
        fetch('/api/sleep/score')
        .then(response => response.json())
        .then(data => {
            const ctx2 = document.getElementById('sleepQualityChart').getContext('2d');
            new Chart(ctx2, {
            type: 'line',
            data: {
                labels: data.labels,
                datasets: [{
                    label: 'Sleep Quality Score (0-21)',
                    data: data.data,
                    borderColor: 'rgba(255, 99, 132, 0.8)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 6,
                    pointBackgroundColor: 'white',
                    pointBorderColor: 'rgba(255, 99, 132, 0.8)',
                    pointBorderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000,
                    easing: 'easeOutQuart'
                },
                plugins: {
                    annotation: {
                        annotations: {
                            zone1: {
                                type: 'box',
                                yMin: 0,
                                yMax: 8,
                                backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                borderColor: 'rgba(255, 99, 132, 0.3)',
                                label: {
                                    content: 'Poor',
                                    display: true,
                                    position: 'start'
                                }
                            },
                            zone2: {
                                type: 'box',
                                yMin: 9,
                                yMax: 13,
                                backgroundColor: 'rgba(255, 159, 64, 0.1)',
                                borderColor: 'rgba(255, 159, 64, 0.3)',
                                label: {
                                    content: 'Fair',
                                    display: true,
                                    position: 'start'
                                }
                            },
                            zone3: {
                                type: 'box',
                                yMin: 14,
                                yMax: 17,
                                backgroundColor: 'rgba(255, 205, 86, 0.1)',
                                borderColor: 'rgba(255, 205, 86, 0.3)',
                                label: {
                                    content: 'Good',
                                    display: true,
                                    position: 'start'
                                }
                            },
                            zone4: {
                                type: 'box',
                                yMin: 18,
                                yMax: 21,
                                backgroundColor: 'rgba(75, 192, 192, 0.1)',
                                borderColor: 'rgba(75, 192, 192, 0.3)',
                                label: {
                                    content: 'Excellent',
                                    display: true,
                                    position: 'start'
                                }
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const value = context.raw;
                                if (value >= 18) return 'Quality: Excellent';
                                if (value >= 14) return 'Quality: Good';
                                if (value >= 9) return 'Quality: Fair';
                                return 'Quality: Poor';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 21,
                        title: {
                            display: true,
                            text: 'Score'
                        }
                    }
                }
            }
        });
        });
        
        // Sleep Quality Distribution Pie Chart
        fetch('/api/sleep/level-distribution')
        .then(response => response.json())
        .then(result => {
            const ctx3 = document.getElementById('sleepQualityPieChart').getContext('2d');
            new Chart(ctx3, {
            type: 'pie',
            data: {
                labels: result.labels,
                datasets: [{
                    data: result.data,
                    backgroundColor: [
                        'rgba(75, 192, 192, 0.7)',   // Excellent
                        'rgba(255, 205, 86, 0.7)',   // Good
                        'rgba(255, 159, 64, 0.7)',   // Fair
                        'rgba(255, 99, 132, 0.7)'    // Poor
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000,
                    animateRotate: true
                },
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            generateLabels: function(chart) {
                                const original = Chart.defaults.plugins.legend.labels.generateLabels(chart);
                                const mapping = {
                                    'Excellent': 'Excellent (18–21)',
                                    'Good': 'Good (14–17)',
                                    'Fair': 'Fair (9–13)',
                                    'Poor': 'Poor (0–8)'
                                };
                                return original.map(label => ({
                                    ...label,
                                    text: mapping[label.text] || label.text
                                }));
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.raw || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${label}: ${value} nights (${percentage}%)`;
                            }
                        }
                    }
                }
            }
        });
        
            });
        });
        
        // Factors Impact Chart
        fetch('/api/sleep/factor-impact')
        .then(response => response.json())
        .then(result => {
            const ctx4 = document.getElementById('factorsImpactChart').getContext('2d');
            new Chart(ctx4, {
            type: 'bar',
            data: {
                labels: result.labels,
                datasets: [{
                    label: 'Average Sleep Quality',
                    data: result.data,
                    backgroundColor: [
                        'rgba(255, 159, 64, 0.7)',
                        'rgba(75, 192, 192, 0.7)',
                        'rgba(153, 102, 255, 0.7)',
                        'rgba(255, 205, 86, 0.7)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Score: ${context.raw}/21`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 21,
                        title: {
                            display: true,
                            text: 'Sleep Quality Score'
                        }
                    }
                }
            }
        });
        
        // Sleep Dimensions Radar Chart
        const dimensionsData = {
            labels: [
                'Subjective Quality',
                'Sleep Latency',
                'Duration',
                'Efficiency',
                'Disturbances',
                'Sleep Meds',
                'Daytime Function'
            ],
            datasets: [{
                label: 'Your Score',
                data: [2.5, 1.8, 2.2, 2.7, 1.5, 3.0, 2.0],
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(75, 192, 192, 1)'
            }, {
                label: 'Average User',
                data: [2.0, 1.5, 2.0, 2.2, 1.8, 2.5, 1.7],
                backgroundColor: 'rgba(153, 102, 255, 0.2)',
                borderColor: 'rgba(153, 102, 255, 1)',
                pointBackgroundColor: 'rgba(153, 102, 255, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(153, 102, 255, 1)'
            }]
        };
        
        const ctx5 = document.getElementById('sleepDimensionsChart').getContext('2d');
        new Chart(ctx5, {
            type: 'radar',
            data: dimensionsData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000
                },
                elements: {
                    line: {
                        borderWidth: 3
                    }
                },
                scales: {
                    r: {
                        angleLines: {
                            display: true
                        },
                        suggestedMin: 0,
                        suggestedMax: 3,
                        ticks: {
                            stepSize: 1
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${context.raw}/3`;
                            }
                        }
                    }
                }
            }
        });
    });
</script>
        
    </div>
</body>
</html>